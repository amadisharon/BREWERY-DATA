
SELECT "BRANDS", SUM("QUANTITY") AS "QUANTITIES"
FROM brewery_data
WHERE "COUNTRIES" NOT IN ('Nigeria', 'Ghana')
AND "YEARS" IN (2019)
GROUP BY "BRANDS"
ORDER BY "QUANTITIES" DESC
LIMIT 3;

SELECT "BRANDS", SUM("QUANTITY") AS "QUANTITIES"
FROM brewery_data
WHERE "COUNTRIES" IN ('Ghana')
GROUP BY "BRANDS"
ORDER BY "QUANTITIES" DESC
LIMIT 2;

select "BRANDS", SUM("QUANTITY") AS "QUANTITIES", SUM("PROFIT") AS "BEER PROFIT"
from "brewery_data"
WHERE "BRANDS" NOT IN ('grand malt', 'beta malt')
and "COUNTRIES" IN ('Nigeria')
AND "YEARS" IN (2017,2018,2019)
GROUP BY "BRANDS"
ORDER BY "QUANTITIES";

SELECT "BRANDS", SUM("QUANTITY") AS "QUANTITIES"
FROM "brewery_data"
WHERE "COUNTRIES" IN ('Nigeria', 'Ghana')
AND "YEARS" IN (2018, 2019)
AND "BRANDS" IN ('grand malt', 'beta malt')
GROUP BY "BRANDS"
ORDER BY "QUANTITIES" DESC 
LIMIT 1;

SELECT "BRANDS", SUM("QUANTITY") AS "QUANTITIES"
FROM "brewery_data"
WHERE "COUNTRIES" IN ('Nigeria')
AND "YEARS"= 2019
GROUP BY "BRANDS"
ORDER BY "QUANTITIES" DESC
LIMIT 1;


select "REGION ", "BRANDS", sum("QUANTITY") as "quantities"
from "brewery_data"
WHERE "COUNTRIES" = 'Nigeria' and "REGION " = 'southsouth'
group by "REGION ", "BRANDS"
order by "quantities"
limit 1;


SELECT "BRANDS", SUM("QUANTITY") AS "QUANTITIES"
FROM "brewery_data"
WHERE "COUNTRIES" = 'Nigeria'
AND "BRANDS" NOT IN ('beta malt', 'grand malt')
GROUP BY "BRANDS"
ORDER BY "QUANTITIES";

SELECT "BRANDS", SUM("QUANTITY") AS "QUANTITIES"
FROM "brewery_data"
WHERE "BRANDS" = 'budweiser'
AND "COUNTRIES" = 'Nigeria'
GROUP BY "BRANDS"
ORDER BY "QUANTITIES";

SELECT "BRANDS", SUM("QUANTITY") AS "QUANTITIES"
FROM "brewery_data"
WHERE "BRANDS" = 'budweiser'
AND "COUNTRIES" = 'Nigeria'
AND "YEARS" = (2019)
GROUP BY "BRANDS"
ORDER BY "QUANTITIES";

		
SELECT "COUNTRIES", SUM("QUANTITY") AS "QUANTITIES"
FROM "brewery_data"
WHERE "BRANDS" NOT IN('Beta malt', 'Grand malt')
GROUP BY "COUNTRIES"
ORDER BY "QUANTITIES"
LIMIT 1;

SELECT "SALES_REP", SUM("QUANTITY") AS "QUANTITIES"
FROM "brewery_data"
WHERE "BRANDS" = 'budweiser'
AND "COUNTRIES" = 'Senegal'
GROUP BY "SALES_REP"
ORDER BY "QUANTITIES"
LIMIT 1;

SELECT "COUNTRIES", SUM("PROFIT") AS "COUNTRY PROFIT"
FROM "brewery_data"
WHERE "MONTHS" IN ('October', 'November', 'December')
AND "YEARS" = 2019
GROUP BY "COUNTRIES"
ORDER BY  "COUNTRY PROFIT" DESC
LIMIT 1;

SELECT *
FROM brewery_data;

-- SECTION A

SELECT SUM("PROFIT") AS "BREWERY PROFIT"
FROM brewery_data;

SELECT SUM("PROFIT") as "sum_profit"
from "brewery_data"
WHERE "COUNTRIES" in ('Nigeria', 'Ghana')
UNION
SELECT SUM("PROFIT") as "sum_profit"
from "brewery_data"
WHERE "COUNTRIES" not in ('Nigeria', 'Ghana');


SELECT  "COUNTRIES", SUM("PROFIT") AS "COUNTRY PROFIT"
FROM brewery_data
WHERE "YEARS" = (2019)
GROUP BY "COUNTRIES"
ORDER BY "COUNTRY PROFIT" DESC
LIMIT 1;

SELECT "YEARS", SUM("PROFIT") AS "PROFITS"
FROM brewery_data
GROUP BY "YEARS"
ORDER BY "PROFITS" DESC
LIMIT 1;

SELECT "MONTHS", SUM("PROFIT") AS "MONTH PROFITS"
FROM brewery_data
GROUP BY "MONTHS"
ORDER BY "MONTH PROFITS" ASC
LIMIT 1;

SELECT "MONTHS", SUM("PROFIT") AS "MONTH PROFITS"
FROM brewery_data
WHERE "YEARS" = 2018
AND "MONTHS" = ('December')
GROUP BY "MONTHS"
ORDER BY "MONTH PROFITS" ASC
LIMIT 1;

SELECT SUM("PERCENTAGE"), "MONTHS"
FROM
   (SELECT "MONTHS", ("PROFIT"/100) AS "PERCENTAGE"
FROM brewery_data
WHERE "YEARS" = 2019
GROUP BY "MONTHS", "PROFIT"
ORDER BY "PERCENTAGE" DESC) AS table_one
GROUP BY "MONTHS";

SELECT "BRANDS", SUM("PROFIT") AS "BRAND PROFIT"
FROM brewery_data
WHERE "COUNTRIES" = ('Senegal')
GROUP BY "BRANDS"
ORDER BY "BRAND PROFIT" DESC
LIMIT 1;